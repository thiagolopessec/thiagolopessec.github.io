<!DOCTYPE html>
<html lang="pt-BR">
<!--
===========================================================
THIAGO LOPES ‚Äî SOC N1 / BLUE TEAM (BR MARKET POSITIONING)
- Data-driven sections (incidents/projects rendered from arrays)
- PT/EN toggle (DRY translations)
- SOC N1-first UX: Incident Reports + Workflow + Capabilities
- Print-friendly
===========================================================
-->
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO -->
  <title>Thiago Lopes | SOC Analyst (N1) ‚Äî Blue Team</title>
  <meta name="description" content="Portf√≥lio de Thiago Lopes ‚Äî SOC N1 / Blue Team. Triagem de alertas, an√°lise de logs, documenta√ß√£o e laborat√≥rio SIEM (Wazuh)." />
  <meta name="author" content="Thiago Lopes" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://thiagolopessec.github.io/" />
  <meta name="theme-color" content="#0a0a0b" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://thiagolopessec.github.io/" />
  <meta property="og:title" content="Thiago Lopes | SOC Analyst (N1) ‚Äî Blue Team" />
  <meta property="og:description" content="SOC N1 focado em triagem, an√°lise de logs e documenta√ß√£o. Home lab com Wazuh SIEM." />
  <meta property="og:image" content="https://github.com/thiagolopessec.png" />
  <meta property="og:locale" content="pt_BR" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ°Ô∏è</text></svg>">

  <style>
    :root{
      --bg-body:#0a0a0b;
      --bg-card:#121214;
      --bg-card-hover:#1c1c1f;

      --text-primary:#ededed;
      --text-secondary:#a1a1aa;

      --accent-primary:#10b981;
      --accent-secondary:#3b82f6;
      --accent-purple:#8b5cf6;
      --accent-alert:#ef4444;

      --border-color:#27272a;
      --radius-md:10px;
      --radius-lg:14px;

      --shadow-lg: 0 14px 38px -18px rgba(0,0,0,0.7);
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      background:var(--bg-body);
      color:var(--text-primary);
      font-family:'Inter',system-ui,sans-serif;
      line-height:1.7;
      overflow-x:hidden;
    }

    h1,h2,h3,.mono,button,input,.tag,textarea{
      font-family:'JetBrains Mono',monospace;
    }

    a{color:inherit}
    a:focus-visible,button:focus-visible,.card:focus-visible,textarea:focus-visible{
      outline:2px solid var(--accent-secondary);
      outline-offset:3px;
      border-radius:8px;
    }

    .container{max-width:1040px;margin:0 auto;padding:2rem;position:relative}

    /* Language switch */
    .lang-switch{
      position:absolute; top:1.25rem; right:2rem;
      display:flex; gap:8px; z-index:30;
    }
    .lang-btn{
      background:transparent;
      border:1px solid var(--border-color);
      color:var(--text-secondary);
      padding:6px 10px;
      cursor:pointer;
      font-size:0.75rem;
      border-radius:var(--radius-md);
      transition:all .18s ease;
    }
    .lang-btn:hover{border-color:rgba(255,255,255,0.18); color:var(--text-primary)}
    .lang-btn.active{background:rgba(255,255,255,0.05); color:var(--text-primary)}

    /* Sticky mini nav */
    .mini-nav{
      display:flex; gap:.6rem; align-items:center; flex-wrap:wrap;
      margin:0 auto 1.25rem auto;
      padding:.65rem .75rem;
      border:1px solid var(--border-color);
      border-radius:var(--radius-md);
      background:rgba(255,255,255,0.02);
      position:sticky; top:1rem; z-index:20;
      backdrop-filter: blur(6px);
    }
    .mini-nav a{
      color:var(--text-secondary);
      text-decoration:none;
      font-size:.85rem;
      padding:5px 9px;
      border-radius:8px;
      transition:all .18s ease;
    }
    .mini-nav a:hover{color:var(--text-primary); background:rgba(255,255,255,0.04)}
    .mini-nav a.active-link{color:var(--accent-primary); background:rgba(16,185,129,0.12)}

    /* Grid */
    .grid{display:grid; gap:1.2rem}
    .grid-2{grid-template-columns:repeat(auto-fit,minmax(320px,1fr))}
    .grid-3{grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}

    /* Header */
    header{
      display:flex; flex-direction:column; align-items:center; text-align:center;
      padding:5.25rem 0 3.15rem;
      border-bottom:1px solid var(--border-color);
      margin-bottom:2.75rem;
    }

    .profile-container{position:relative; width:118px; height:118px; margin-bottom:1.25rem}
    .profile-img{
      width:100%; height:100%;
      border-radius:50%;
      object-fit:cover;
      border:2px solid var(--border-color);
      background:var(--bg-card);
      position:relative; z-index:2;
    }
    .status-ring{
      position:absolute; inset:-5px; border-radius:50%;
      border:2px solid transparent;
      border-top-color:var(--accent-primary);
      border-right-color:var(--accent-primary);
      opacity:.65;
      animation:spin 4.2s linear infinite;
      z-index:1;
    }
    @keyframes spin{100%{transform:rotate(360deg)}}

    h1{
      font-size:2.55rem;
      font-weight:800;
      letter-spacing:-0.05em;
      margin-bottom:.55rem;
      background:linear-gradient(to right,#fff,#a1a1aa);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }

    .tagline{
      color:var(--accent-primary);
      font-size:0.9rem;
      background:rgba(16,185,129,0.11);
      padding:6px 14px;
      border-radius:999px;
      border:1px solid rgba(16,185,129,0.22);
      display:inline-block;
      margin-bottom:.85rem;
    }

    .subtitle{
      color:var(--text-secondary);
      font-size:.95rem;
      max-width:920px;
      line-height:1.75;
      margin-bottom:1.05rem;
    }

    .pill-row{
      display:flex; flex-wrap:wrap; justify-content:center;
      gap:8px; margin:.25rem 0 1rem;
    }
    .pill{
      font-size:.74rem;
      padding:4px 10px;
      border:1px solid var(--border-color);
      border-radius:999px;
      color:var(--text-secondary);
      background:rgba(255,255,255,0.02);
      font-family:'JetBrains Mono',monospace;
    }

    .cta{
      margin-top:.35rem;
      display:flex; gap:.75rem; flex-wrap:wrap; justify-content:center;
    }
    .cta a{
      text-decoration:none;
      border:1px solid var(--border-color);
      padding:.7rem 1rem;
      border-radius:var(--radius-md);
      font-size:.85rem;
      color:var(--text-primary);
      background:rgba(255,255,255,0.02);
      transition:all .18s ease;
      display:inline-flex; gap:.5rem; align-items:center;
    }
    .cta a:hover{border-color:rgba(16,185,129,0.6); color:var(--accent-primary)}
    .cta a.primary{
      border-color:rgba(16,185,129,0.35);
      background:rgba(16,185,129,0.08);
    }
    .cta a.primary:hover{border-color:rgba(16,185,129,0.8)}

    .social-nav{display:flex; gap:1rem; margin-top:1.05rem; flex-wrap:wrap; justify-content:center}
    .social-link{
      color:var(--text-secondary);
      text-decoration:none;
      font-size:1.02rem;
      transition:color .18s ease;
    }
    .social-link:hover{color:var(--text-primary)}
    .sep{color:var(--border-color)}

    /* Sections */
    section{margin-bottom:3.5rem}
    section.alt{
      padding:2.15rem 0;
      border-top:1px solid rgba(255,255,255,0.02);
      border-bottom:1px solid rgba(255,255,255,0.02);
      background:rgba(255,255,255,0.015);
      border-radius:var(--radius-lg);
    }
    .section-header{
      display:flex; align-items:center; gap:1rem;
      margin-bottom:1.4rem;
      padding:0 0.2rem;
    }
    .section-title{font-size:1.45rem; color:var(--text-primary)}
    .section-line{flex-grow:1; height:1px; background:var(--border-color)}
    .section-kicker{
      font-size:.75rem;
      color:var(--text-secondary);
      border:1px solid var(--border-color);
      padding:3px 8px;
      border-radius:999px;
      background:rgba(255,255,255,0.02);
      margin-left:auto;
      font-family:'JetBrains Mono',monospace;
    }

    /* Cards */
    .card{
      background:var(--bg-card);
      border:1px solid var(--border-color);
      border-radius:var(--radius-lg);
      padding:1.35rem;
      transition:transform .18s ease, border-color .18s ease, box-shadow .18s ease;
      display:flex; flex-direction:column; height:100%;
    }
    .card:hover{
      border-color:rgba(59,130,246,0.7);
      transform:translateY(-2px);
      box-shadow:var(--shadow-lg);
    }
    .card-icon{font-size:1.5rem; margin-bottom:.85rem}
    .card h3{font-size:1.05rem; margin-bottom:.35rem}
    .card p{font-size:.92rem; color:var(--text-secondary); line-height:1.55}

    .meta-row{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:.85rem;
    }
    .tag{
      font-size:.74rem;
      padding:3px 9px;
      border-radius:7px;
      background:rgba(255,255,255,0.05);
      color:var(--text-secondary);
      border:1px solid rgba(255,255,255,0.06);
    }
    .tag.good{border-color:rgba(16,185,129,0.35); background:rgba(16,185,129,0.08); color:var(--accent-primary)}
    .tag.info{border-color:rgba(59,130,246,0.35); background:rgba(59,130,246,0.08); color:var(--accent-secondary)}
    .tag.warn{border-color:rgba(239,68,68,0.35); background:rgba(239,68,68,0.08); color:#ffb4b4}

    .link-row{
      margin-top:1rem;
      display:flex;
      gap:.75rem;
      flex-wrap:wrap;
      align-items:center;
    }
    .project-link{
      display:inline-flex;
      align-items:center;
      gap:.4rem;
      font-size:.84rem;
      color:var(--accent-secondary);
      text-decoration:none;
      border-bottom:1px dashed rgba(59,130,246,0.55);
      width:fit-content;
    }
    .project-link:hover{opacity:.9; border-bottom-style:solid}
    .muted{
      color:var(--text-secondary);
      font-size:.84rem;
      border:1px solid var(--border-color);
      padding:6px 10px;
      border-radius:10px;
      background:rgba(255,255,255,0.02);
      font-family:'JetBrains Mono',monospace;
    }
    /* Make inactive "chips" look clearly disabled */
    .muted.disabled{
      opacity:.65;
      filter:grayscale(1);
      cursor:not-allowed;
      user-select:none;
    }

    /* Incident detail */
    .incident-body{
      margin-top:.65rem;
      border-top:1px solid rgba(255,255,255,0.06);
      padding-top:.9rem;
      display:grid;
      gap:.65rem;
    }
    .kv{
      font-family:'JetBrains Mono',monospace;
      font-size:.84rem;
      color:var(--text-secondary);
      background:rgba(255,255,255,0.02);
      border:1px solid var(--border-color);
      border-radius:12px;
      padding:.85rem;
      white-space:pre-wrap;
      line-height:1.55;
    }

    /* Workflow */
    .steps{
      display:grid;
      gap:10px;
    }
    .step{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:12px 12px;
      border:1px solid var(--border-color);
      border-radius:14px;
      background:rgba(255,255,255,0.02);
    }
    .step-num{
      width:34px;height:34px;border-radius:10px;
      display:flex;align-items:center;justify-content:center;
      border:1px solid rgba(16,185,129,0.35);
      background:rgba(16,185,129,0.08);
      color:var(--accent-primary);
      font-family:'JetBrains Mono',monospace;
      flex:0 0 auto;
    }
    .step p{color:var(--text-secondary); font-size:.92rem; margin-top:2px}

    /* Lab (Triage helper) */
    .terminal-window{
      background:#0d0d0d;
      border:1px solid var(--border-color);
      border-radius:var(--radius-lg);
      overflow:hidden;
    }
    .terminal-header{
      background:#1a1a1a;
      padding:.75rem 1rem;
      display:flex; gap:8px; align-items:center;
      border-bottom:1px solid var(--border-color);
    }
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.red{background:#ef4444}
    .dot.yellow{background:#f59e0b}
    .dot.green{background:#10b981}
    .terminal-title{color:var(--text-secondary)}
    .terminal-body{padding:1.35rem}

    .lab-grid{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }
    @media (min-width:860px){
      .lab-grid{grid-template-columns:1.2fr 0.8fr}
    }

    .terminal-textarea{
      width:100%;
      min-height:190px;
      resize:vertical;
      background:transparent;
      border:1px solid var(--border-color);
      border-radius:12px;
      padding:.85rem .9rem;
      font-family:'JetBrains Mono',monospace;
      font-size:.9rem;
      color:var(--text-primary);
      outline:none;
      line-height:1.55;
    }
    .terminal-textarea:focus{border-color:rgba(16,185,129,0.7)}

    .btn-row{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top:.75rem;
    }
    .btn{
      background:var(--bg-card-hover);
      color:var(--text-primary);
      border:1px solid var(--border-color);
      padding:.72rem 1rem;
      border-radius:var(--radius-md);
      font-size:.88rem;
      cursor:pointer;
      transition:all .18s ease;
      font-family:'JetBrains Mono',monospace;
    }
    .btn:hover{border-color:rgba(16,185,129,0.55); color:var(--accent-primary)}
    .btn.secondary:hover{border-color:rgba(59,130,246,0.55); color:var(--accent-secondary)}
    .btn.ghost:hover{border-color:rgba(161,161,170,0.55); color:var(--text-primary)}

    .output-box{
      border:1px solid var(--border-color);
      border-radius:12px;
      padding:1rem;
      background:rgba(255,255,255,0.02);
      color:var(--text-secondary);
      min-height:190px;
      font-family:'JetBrains Mono',monospace;
      white-space:pre-wrap;
      line-height:1.55;
    }
    .hint{
      color:var(--text-secondary);
      font-size:.82rem;
      margin-top:.65rem;
    }
    .hint code{
      color:var(--text-primary);
      background:rgba(255,255,255,0.06);
      padding:2px 6px;
      border-radius:7px;
      border:1px solid var(--border-color);
    }

    /* Reveal */
    .reveal{opacity:0; transform:translateY(16px); transition:all .55s cubic-bezier(0.2,0.8,0.2,1)}
    .reveal.active{opacity:1; transform:translateY(0)}

    /* Footer */
    footer{
      margin-top:2.75rem;
      padding:1.5rem 0 1rem;
      border-top:1px solid var(--border-color);
    }
    footer p{color:var(--text-secondary); font-size:.82rem; text-align:center}

    /* Responsive */
    @media (max-width:640px){
      h1{font-size:1.85rem}
      .container{padding:1.25rem}
      header{padding:4.4rem 0 2.4rem}
      .lang-switch{right:1.25rem}
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .status-ring, .reveal{animation:none !important; transition:none !important}
      *{scroll-behavior:auto !important}
    }

    /* PRINT */
    @media print{
      *{
        background:transparent !important;
        color:#000 !important;
        box-shadow:none !important;
        text-shadow:none !important;
        animation:none !important;
        transition:none !important;
      }
      html,body{
        background:#fff !important;
        color:#000 !important;
        font-size:12pt;
        line-height:1.4;
      }
      .lang-switch,.mini-nav,.status-ring,
      .terminal-window,.btn,.cta{
        display:none !important;
      }
      header{
        padding:1.2rem 0 !important;
        margin-bottom:1.2rem !important;
        border-bottom:1px solid #ccc !important;
      }
      h1{
        font-size:22pt !important;
        -webkit-text-fill-color:#000 !important;
      }
      .tagline{
        border:1px solid #000 !important;
        background:none !important;
      }
      .card, .step{
        border:1px solid #ccc !important;
        page-break-inside:avoid;
        margin-bottom:1rem !important;
      }
      section{page-break-inside:avoid}
      a::after{
        content:" (" attr(href) ")";
        font-size:9pt;
        color:#555 !important;
      }
      footer{
        border-top:1px solid #ccc !important;
        margin-top:1.2rem !important;
        padding-top:.5rem !important;
      }
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- Language Switch -->
    <nav class="lang-switch" aria-label="Language switch">
      <button class="lang-btn active" id="btn-pt" type="button" aria-pressed="true">PT</button>
      <button class="lang-btn" id="btn-en" type="button" aria-pressed="false">EN</button>
    </nav>

    <!-- Mini Nav -->
    <nav class="mini-nav" aria-label="Navega√ß√£o r√°pida / Quick nav">
      <a href="#capabilities" data-translate="nav_cap">SOC Capabilities</a>
      <a href="#incidents" data-translate="nav_inc">Incident Reports</a>
      <a href="#workflow" data-translate="nav_flow">Workflow</a>
      <a href="#projects" data-translate="nav_proj">Projetos</a>
      <a href="#lab" data-translate="nav_lab">Triage Helper</a>
      <a href="#education" data-translate="nav_edu">Edu/Cert</a>
    </nav>

    <!-- HEADER -->
    <header class="reveal" id="about">
      <div class="profile-container">
        <div class="status-ring"></div>
        <img class="profile-img" src="https://github.com/thiagolopessec.png" alt="Thiago Lopes" loading="lazy" />
      </div>

      <h1 id="name" data-value="Thiago Lopes">Thiago Lopes</h1>
      <div class="tagline mono" data-translate="headline">&lt;SOC Analyst (N1) / Blue Team&gt;</div>

      <div class="pill-row" aria-label="Key focus areas">
        <span class="pill">Alert Triage</span>
        <span class="pill">Log Analysis</span>
        <span class="pill">Incident Documentation</span>
        <span class="pill">Wazuh (SIEM)</span>
        <span class="pill">Windows / Linux</span>
      </div>

      <p class="subtitle" data-translate="bio">
        Profissional em transi√ß√£o para Security Operations com 15 anos em ambiente cr√≠tico (Urg√™ncia/Emerg√™ncia). Atuo com triagem estruturada, prioriza√ß√£o sob press√£o e documenta√ß√£o precisa ‚Äî aplicando esses princ√≠pios √† an√°lise inicial de alertas e escalonamento em ambiente SOC.
      </p>

      <div class="cta" role="group" aria-label="Calls to action">
        <a class="primary" href="mailto:tlopes.dev@gmail.com">
          <span class="mono" data-translate="cta_email">Contactar</span> ‚úâÔ∏è
        </a>
        <a href="#incidents">
          <span class="mono" data-translate="cta_cases">Ver Incident Reports</span> üßæ
        </a>
        <a href="javascript:void(0)" id="btn-print">
          <span class="mono" data-translate="cta_pdf">Salvar PDF</span> üñ®Ô∏è
        </a>
      </div>

      <nav class="social-nav" aria-label="Social links">
        <a class="social-link" href="https://github.com/thiagolopessec" target="_blank" rel="noopener">GitHub</a>
        <span class="sep">|</span>
        <a class="social-link" href="https://linkedin.com/in/thiagolopessec" target="_blank" rel="noopener">LinkedIn</a>
        <span class="sep">|</span>
        <a class="social-link" href="mailto:tlopes.dev@gmail.com" rel="noopener">Email</a>
      </nav>
    </header>

    <!-- CAPABILITIES -->
    <section class="reveal alt" id="capabilities">
      <div class="section-header">
        <h2 class="section-title mono" data-translate="cap_title">01. SOC Operational Capabilities</h2>
        <div class="section-line"></div>
        <span class="section-kicker" data-translate="cap_kicker">N1 Focus</span>
      </div>

      <div class="grid grid-3" id="capabilities-grid"></div>
    </section>

    <!-- INCIDENT REPORTS -->
    <section class="reveal" id="incidents">
      <div class="section-header">
        <h2 class="section-title mono" data-translate="inc_title">02. Incident Reports (Lab-Based)</h2>
        <div class="section-line"></div>
        <span class="section-kicker" data-translate="inc_kicker">Triage-ready</span>
      </div>

      <div class="grid grid-2" id="incidents-grid"></div>
    </section>

    <!-- WORKFLOW -->
    <section class="reveal alt" id="workflow">
      <div class="section-header">
        <h2 class="section-title mono" data-translate="flow_title">03. My Alert Triage Workflow</h2>
        <div class="section-line"></div>
        <span class="section-kicker" data-translate="flow_kicker">Process</span>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-icon">üîÑ</div>
          <h3 data-translate="flow_card_title">Workflow (SOC N1)</h3>
          <p data-translate="flow_card_desc">Fluxo de triagem e documenta√ß√£o voltado a reduzir falso positivo e escalar corretamente quando necess√°rio.</p>

          <div class="incident-body">
            <div class="steps" id="workflow-steps"></div>
          </div>

          <div class="meta-row" style="margin-top:1rem">
            <span class="tag good" data-translate="flow_tag_1">Consistency</span>
            <span class="tag info" data-translate="flow_tag_2">Communication</span>
            <span class="tag" data-translate="flow_tag_3">Ticketing</span>
          </div>
        </div>

        <div class="card">
          <div class="card-icon">üß†</div>
          <h3 data-translate="transfer_title">Transferable Skills</h3>
          <p data-translate="transfer_desc">
            Minha experi√™ncia em Urg√™ncia/Emerg√™ncia fortalece triagem sob press√£o, prioriza√ß√£o, handoff e comunica√ß√£o objetiva ‚Äî pilares de opera√ß√£o SOC 24/7.
          </p>

          <div class="kv" data-translate="transfer_block">
Emergency Care ‚Üí SOC
- Triagem r√°pida ‚Üí Alert Triage
- Prioriza√ß√£o ‚Üí Severity Classification
- Crise ‚Üí Incident Handling
- Handoff ‚Üí Escalation + Ticket Notes
          </div>

          <div class="meta-row">
            <span class="tag good" data-translate="shift_tag">Shift-ready</span>
            <span class="tag" data-translate="pressure_tag">High-pressure ops</span>
          </div>
        </div>
      </div>
    </section>

    <!-- PROJECTS -->
    <section class="reveal" id="projects">
      <div class="section-header">
        <h2 class="section-title mono" data-translate="proj_title">04. Projects</h2>
        <div class="section-line"></div>
        <span class="section-kicker" data-translate="proj_kicker">Evidence</span>
      </div>

      <div class="grid grid-2" id="projects-grid"></div>
    </section>

    <!-- LAB (Triage Helper) -->
    <section class="reveal alt" id="lab">
      <div class="section-header">
        <h2 class="section-title mono" data-translate="lab_title">05. Triage Helper ‚Äî Log Parsing (Windows 4625)</h2>
        <div class="section-line"></div>
        <span class="section-kicker" data-translate="lab_kicker">SOC N1</span>
      </div>

      <div class="terminal-window" role="region" aria-label="Triage helper">
        <div class="terminal-header">
          <div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div>
          <div class="terminal-title mono">triage_helper_regex.js (simulator)</div>
        </div>

        <div class="terminal-body">
          <div class="lab-grid">
            <div>
              <textarea id="log_input" class="terminal-textarea" spellcheck="false"></textarea>

              <div class="btn-row">
                <button class="btn" id="btn_parse" type="button" style="border-color:rgba(16,185,129,0.55); color:var(--accent-primary)">
                  <span data-translate="btn_parse">EXTRAIR (IoCs + Severidade)</span>
                </button>
                <button class="btn secondary" id="btn_sample" type="button" style="border-color:rgba(59,130,246,0.55); color:var(--accent-secondary)">
                  <span data-translate="btn_sample">CARREGAR EXEMPLO 4625</span>
                </button>
                <button class="btn ghost" id="btn_clear" type="button" style="border-color:rgba(161,161,170,0.55);">
                  <span data-translate="btn_clear">LIMPAR</span>
                </button>
              </div>

              <div class="hint" data-translate="lab_hint">
                Dica: isso simula a extra√ß√£o r√°pida para ‚Äúfirst-pass triage‚Äù (IP, user, host, event_id) + sugest√£o de severidade e pr√≥ximos passos.
              </div>
            </div>

            <div>
              <div class="output-box" id="parse_output" aria-live="polite" role="status">// Awaiting Input...</div>
              <div class="hint" data-translate="lab_hint2">
                Objetivo: acelerar documenta√ß√£o em ticket e decis√£o de escalonamento.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- EDUCATION -->
    <section class="reveal" id="education">
      <div class="section-header">
        <h2 class="section-title mono" data-translate="edu_title">06. Education & Certifications</h2>
        <div class="section-line"></div>
        <span class="section-kicker" data-translate="edu_kicker">Roadmap</span>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-icon">üéì</div>
          <h3 data-translate="edu_1_title">An√°lise e Desenvolvimento de Sistemas</h3>
          <p data-translate="edu_1_desc">FADERGS. Base em redes, arquitetura e seguran√ßa da informa√ß√£o.</p>
          <div class="meta-row">
            <span class="tag" id="grad-counter">‚è≥ ...</span>
            <span class="tag info" data-translate="edu_tag_1">Networking</span>
            <span class="tag" data-translate="edu_tag_2">Security</span>
          </div>
        </div>

        <div class="card">
          <div class="card-icon">üìú</div>
          <h3 data-translate="edu_2_title">Google Cybersecurity Certificate</h3>
          <p data-translate="edu_2_desc">Trilha focada em fundamentos e pr√°tica para opera√ß√µes de seguran√ßa. (Em andamento.)</p>
          <div class="meta-row">
            <span class="tag good" data-translate="cert_in_progress">In progress</span>
            <span class="tag" data-translate="edu_focus_1">SOC fundamentals</span>
            <span class="tag" data-translate="edu_focus_2">Risk + logs</span>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <p class="mono">
        Thiago Lopes ¬© 2026 ‚Äî <span style="color:var(--accent-primary)" data-translate="footer_tag">SOC N1 mindset: triage ‚Ä¢ documentation ‚Ä¢ escalation.</span>
      </p>
    </footer>

  </div>

  <script>
    // =======================
    // TRANSLATIONS (DRY)
    // =======================
    const translations = {
      pt: {
        nav_cap: "SOC Capabilities",
        nav_inc: "Incident Reports",
        nav_flow: "Workflow",
        nav_proj: "Projetos",
        nav_lab: "Triage Helper",
        nav_edu: "Edu/Cert",

        headline: "&lt;SOC Analyst (N1) / Blue Team&gt;",
        bio: "Profissional em transi√ß√£o para Security Operations com <strong>15 anos</strong> em ambiente cr√≠tico (Urg√™ncia/Emerg√™ncia). Atuo com triagem estruturada, prioriza√ß√£o sob press√£o e documenta√ß√£o precisa ‚Äî aplicando esses princ√≠pios √† <strong>an√°lise inicial de alertas</strong> e <strong>escalonamento</strong> em ambiente SOC.",

        cta_email: "Contactar",
        cta_cases: "Ver Incident Reports",
        cta_pdf: "Salvar PDF",

        cap_title: "01. SOC Operational Capabilities",
        cap_kicker: "N1 Focus",

        inc_title: "02. Incident Reports (Baseados em Lab)",
        inc_kicker: "Triage-ready",

        flow_title: "03. Meu Workflow de Triagem",
        flow_kicker: "Process",
        flow_card_title: "Workflow (SOC N1)",
        flow_card_desc: "Fluxo de triagem e documenta√ß√£o voltado a reduzir falso positivo e escalar corretamente quando necess√°rio.",
        flow_tag_1: "Consist√™ncia",
        flow_tag_2: "Comunica√ß√£o",
        flow_tag_3: "Ticketing",

        transfer_title: "Compet√™ncias Transfer√≠veis",
        transfer_desc: "Minha experi√™ncia em Urg√™ncia/Emerg√™ncia fortalece triagem sob press√£o, prioriza√ß√£o, handoff e comunica√ß√£o objetiva ‚Äî pilares de opera√ß√£o SOC 24/7.",
        transfer_block: `Urg√™ncia/Emerg√™ncia ‚Üí SOC
- Triagem r√°pida ‚Üí Alert Triage
- Prioriza√ß√£o ‚Üí Severity Classification
- Crise ‚Üí Incident Handling
- Handoff ‚Üí Escalation + Ticket Notes`,
        shift_tag: "Pronto para turno",
        pressure_tag: "Opera√ß√£o sob press√£o",

        proj_title: "04. Projetos",
        proj_kicker: "Evid√™ncia",

        lab_title: "05. Triage Helper ‚Äî Log Parsing (Windows 4625)",
        lab_kicker: "SOC N1",
        btn_parse: "EXTRAIR (IoCs + Severidade)",
        btn_sample: "CARREGAR EXEMPLO 4625",
        btn_clear: "LIMPAR",
        lab_hint: "Dica: isso simula a extra√ß√£o r√°pida para ‚Äúfirst-pass triage‚Äù (IP, user, host, event_id) + sugest√£o de severidade e pr√≥ximos passos.",
        lab_hint2: "Objetivo: acelerar documenta√ß√£o em ticket e decis√£o de escalonamento.",

        edu_title: "06. Forma√ß√£o & Certifica√ß√µes",
        edu_kicker: "Roadmap",
        edu_1_title: "An√°lise e Desenvolvimento de Sistemas",
        edu_1_desc: "FADERGS. Base em redes, arquitetura e seguran√ßa da informa√ß√£o.",
        edu_2_title: "Google Cybersecurity Certificate",
        edu_2_desc: "Trilha focada em fundamentos e pr√°tica para opera√ß√µes de seguran√ßa. (Em andamento.)",
        edu_tag_1: "Redes",
        edu_tag_2: "Seguran√ßa",
        cert_in_progress: "Em andamento",
        edu_focus_1: "Fundamentos SOC",
        edu_focus_2: "Risco + logs",

        footer_tag: "Mindset SOC N1: triagem ‚Ä¢ documenta√ß√£o ‚Ä¢ escalonamento.",

        out_empty: "ERRO: Entrada vazia.",
        out_nohits: "Nenhum match encontrado. Verifique o formato do log.",
        out_results: "RESULTADO (extra√≠do para triagem):",
        out_next: "Pr√≥ximos passos sugeridos (N1):",
        sev_low: "Baixa",
        sev_med: "M√©dia",
        sev_high: "Alta",

        proj_open: "Abrir projeto ‚Üí",
        proj_repo: "Repo (evid√™ncias) ‚Üí"
      },

      en: {
        nav_cap: "SOC Capabilities",
        nav_inc: "Incident Reports",
        nav_flow: "Workflow",
        nav_proj: "Projects",
        nav_lab: "Triage Helper",
        nav_edu: "Edu/Cert",

        headline: "&lt;SOC Analyst (N1) / Blue Team&gt;",
        bio: "Career switcher into Security Operations with <strong>15 years</strong> in high-pressure frontline emergency care. Strong in structured triage, prioritization and precise documentation ‚Äî applying those principles to <strong>first-pass alert analysis</strong> and <strong>proper escalation</strong> in a SOC environment.",

        cta_email: "Contact",
        cta_cases: "View Incident Reports",
        cta_pdf: "Save PDF",

        cap_title: "01. SOC Operational Capabilities",
        cap_kicker: "N1 Focus",

        inc_title: "02. Incident Reports (Lab-Based)",
        inc_kicker: "Triage-ready",

        flow_title: "03. My Alert Triage Workflow",
        flow_kicker: "Process",
        flow_card_title: "Workflow (SOC N1)",
        flow_card_desc: "Triage + documentation workflow designed to reduce false positives and escalate correctly when needed.",
        flow_tag_1: "Consistency",
        flow_tag_2: "Communication",
        flow_tag_3: "Ticketing",

        transfer_title: "Transferable Skills",
        transfer_desc: "Frontline emergency care experience strengthens triage under pressure, prioritization, handoff and concise communication ‚Äî core skills for a 24/7 SOC.",
        transfer_block: `Emergency Care ‚Üí SOC
- Rapid triage ‚Üí Alert Triage
- Prioritization ‚Üí Severity Classification
- Crisis handling ‚Üí Incident Handling
- Handoff ‚Üí Escalation + Ticket Notes`,
        shift_tag: "Shift-ready",
        pressure_tag: "High-pressure ops",

        proj_title: "04. Projects",
        proj_kicker: "Evidence",

        lab_title: "05. Triage Helper ‚Äî Log Parsing (Windows 4625)",
        lab_kicker: "SOC N1",
        btn_parse: "EXTRACT (IoCs + Severity)",
        btn_sample: "LOAD 4625 SAMPLE",
        btn_clear: "CLEAR",
        lab_hint: "Tip: this simulates quick first-pass triage extraction (IP, user, host, event_id) + severity suggestion and next steps.",
        lab_hint2: "Goal: speed up ticket notes and escalation decisions.",

        edu_title: "06. Education & Certifications",
        edu_kicker: "Roadmap",
        edu_1_title: "Systems Analysis & Development",
        edu_1_desc: "FADERGS. Foundations in networking, architecture and information security.",
        edu_2_title: "Google Cybersecurity Certificate",
        edu_2_desc: "Track focused on fundamentals and hands-on security operations practice. (In progress.)",
        edu_tag_1: "Networking",
        edu_tag_2: "Security",
        cert_in_progress: "In progress",
        edu_focus_1: "SOC fundamentals",
        edu_focus_2: "Risk + logs",

        footer_tag: "SOC N1 mindset: triage ‚Ä¢ documentation ‚Ä¢ escalation.",

        out_empty: "ERROR: Empty input.",
        out_nohits: "No matches found. Check the log format.",
        out_results: "RESULT (triage extraction):",
        out_next: "Suggested next steps (N1):",
        sev_low: "Low",
        sev_med: "Medium",
        sev_high: "High",

        proj_open: "Open project ‚Üí",
        proj_repo: "Repo (evidence) ‚Üí"
      }
    };

    // =======================
    // APP (DATA-DRIVEN)
    // =======================
    const app = {
      lang: (() => {
        try{
          return localStorage.getItem('lang') || (document.documentElement.lang?.toLowerCase().startsWith('pt') ? 'pt' : 'en');
        }catch(_){
          return (document.documentElement.lang?.toLowerCase().startsWith('pt') ? 'pt' : 'en');
        }
      })(),

      milestoneTargetISO: "2026-06-30T00:00:00-03:00",

      capabilities: [
        {
          icon: "üõ∞Ô∏è",
          title: { pt: "Alert Triage", en: "Alert Triage" },
          desc:  { pt: "Triagem inicial de alertas (contexto, repeti√ß√£o, impacto).", en: "First-pass triage (context, repetition, potential impact)." },
          tags:  ["N1", "Process"]
        },
        {
          icon: "üßæ",
          title: { pt: "Incident Documentation", en: "Incident Documentation" },
          desc:  { pt: "Registro claro em ticket: evid√™ncias, decis√£o e pr√≥ximos passos.", en: "Clear ticket notes: evidence, decision, and next actions." },
          tags:  ["Tickets", "Handoff"]
        },
        {
          icon: "ü™µ",
          title: { pt: "Log Analysis (Win/Linux)", en: "Log Analysis (Win/Linux)" },
          desc:  { pt: "Leitura e extra√ß√£o de campos √∫teis (4625/4624/4688, auth logs).", en: "Reading and extracting useful fields (4625/4624/4688, auth logs)." },
          tags:  ["Windows", "Linux"]
        },
        {
          icon: "üß≠",
          title: { pt: "Severity Classification", en: "Severity Classification" },
          desc:  { pt: "Classifica√ß√£o Low/Medium/High com justificativa objetiva.", en: "Low/Medium/High classification with objective rationale." },
          tags:  ["Impact", "Priority"]
        },
        {
          icon: "üß©",
          title: { pt: "Basic Correlation", en: "Basic Correlation" },
          desc:  { pt: "Correla√ß√£o simples (ex.: 4625 ‚Üí 4624; IP ‚Üí usu√°rio ‚Üí host).", en: "Basic correlation (e.g., 4625 ‚Üí 4624; IP ‚Üí user ‚Üí host)." },
          tags:  ["Context", "Pattern"]
        },
        {
          icon: "üõ°Ô∏è",
          title: { pt: "SIEM Monitoring (Wazuh)", en: "SIEM Monitoring (Wazuh)" },
          desc:  { pt: "Lab com ingest√£o de logs, alertas e pr√°tica de triagem.", en: "Lab SIEM with log ingestion, alerts, and triage practice." },
          tags:  ["Wazuh", "Lab"]
        }
      ],

      incidents: [
        {
          icon: "üîê",
          title: { pt: "Multiple Failed Logons (Windows 4625)", en: "Multiple Failed Logons (Windows 4625)" },
          summary: {
            pt: "Triagem de falhas repetidas de autentica√ß√£o com extra√ß√£o de evid√™ncias e decis√£o de escalonamento.",
            en: "Triage repeated authentication failures with evidence extraction and escalation decision."
          },
          meta: [
            { k: "Log Source", v: { pt: "Windows Security", en: "Windows Security" } },
            { k: "Event ID",   v: { pt: "4625", en: "4625" } },
            { k: "Severity",   v: { pt: "M√©dia", en: "Medium" } },
            { k: "MITRE",      v: { pt: "T1110 (Brute Force)", en: "T1110 (Brute Force)" } }
          ],
          evidence: `EventID=4625
TargetUserName=thiago
IpAddress=192.168.1.23
LogonType=3
Status=0xC000006D
SubStatus=0xC000006A`,
          decision: {
            pt: "Decis√£o: True Positive (simulado em lab). A√ß√£o: documentar, verificar 4624 subsequente e origem do IP; escalar se houver sucesso/impacto.",
            en: "Decision: True Positive (lab simulated). Action: document, check subsequent 4624 and IP origin; escalate if success/impact exists."
          },
          tags: ["Auth", "Triage", "4625"]
        },
        {
          icon: "üåê",
          title: { pt: "Exposed Service / Port Scan Validation", en: "Exposed Service / Port Scan Validation" },
          summary: {
            pt: "Identifica√ß√£o de servi√ßo exposto e valida√ß√£o via banner/Nmap para recomendar hardening.",
            en: "Identify exposed service and validate via banner/Nmap to recommend hardening."
          },
          meta: [
            { k: "Source",   v: { pt: "Scanner + Nmap", en: "Scanner + Nmap" } },
            { k: "Finding",  v: { pt: "Porta 8009 (AJP)", en: "Port 8009 (AJP)" } },
            { k: "Severity", v: { pt: "Baixa/M√©dia", en: "Low/Medium" } },
            { k: "Outcome",  v: { pt: "Hardening", en: "Hardening" } }
          ],
          evidence: `nmap -p 8009 --script=banner 192.168.1.4
PORT     STATE SERVICE
8009/tcp open  ajp13`,
          decision: {
            pt: "Decis√£o: exposi√ß√£o desnecess√°ria em cen√°rio interno. A√ß√£o: recomendar restri√ß√£o via firewall/ACL e registrar evid√™ncia no ticket.",
            en: "Decision: unnecessary internal exposure. Action: recommend firewall/ACL restriction and document evidence in ticket."
          },
          tags: ["Network", "Inventory", "Hardening"]
        },
        {
          icon: "üß™",
          title: { pt: "Suspicious Process (Windows 4688 / Simulado)", en: "Suspicious Process (Windows 4688 / Simulated)" },
          summary: {
            pt: "Caso de treino: cria√ß√£o de processo com par√¢metros suspeitos para praticar documenta√ß√£o e correla√ß√£o b√°sica.",
            en: "Training case: suspicious process creation to practice documentation and basic correlation."
          },
          meta: [
            { k: "Log Source", v: { pt: "Windows Security", en: "Windows Security" } },
            { k: "Event ID",   v: { pt: "4688", en: "4688" } },
            { k: "Severity",   v: { pt: "M√©dia (treino)", en: "Medium (training)" } },
            { k: "MITRE",      v: { pt: "T1059 (Command & Scripting)", en: "T1059 (Command & Scripting)" } }
          ],
          evidence: `EventID=4688
NewProcessName=powershell.exe
CommandLine=powershell -enc <base64>
ParentProcess=explorer.exe`,
          decision: {
            pt: "Decis√£o: cen√°rio simulado. A√ß√£o: documentar (parent/child, cmdline), comparar baseline e escalar se ocorrer fora de padr√£o.",
            en: "Decision: simulated scenario. Action: document (parent/child, cmdline), compare baseline and escalate if out-of-pattern."
          },
          tags: ["Windows", "4688", "Documentation"]
        }
      ],

      // ‚úÖ PROJECTS: removed Port Scanner + Home Lab (not in production)
      // ‚úÖ Added: Home Network Security Audit (public GitHub Pages path + repo link)
      projects: [
        {
          icon: "üõ°Ô∏è",
          title: { pt: "Home Network Security Audit ‚Äî NIST CSF", en: "Home Network Security Audit ‚Äî NIST CSF" },
          desc: {
            pt: "Auditoria de rede dom√©stica baseada no NIST CSF: invent√°rio (LAN), enumera√ß√£o controlada, evid√™ncias (Nmap), findings e plano de hardening (roteador/IoT).",
            en: "NIST CSF-based home network audit: LAN inventory, controlled enumeration, evidence (Nmap), findings and a hardening plan (router/IoT)."
          },
          tags: ["NIST CSF", "Network Inventory", "Hardening", "Evidence"],
          links: {
            page: { href: "./home-network-security-audit/", label_pt: "Abrir projeto ‚Üí", label_en: "Open project ‚Üí" },
            repo: { href: "https://github.com/thiagolopessec/thiagolopessec.github.io/tree/main/home-network-security-audit", label_pt: "Repo (evid√™ncias) ‚Üí", label_en: "Repo (evidence) ‚Üí" }
          }
        }
      ],

      workflow: [
        { pt: "Validar a fonte e o tipo do alerta (log source / rule).", en: "Validate source and alert type (log source / rule)." },
        { pt: "Confirmar relev√¢ncia (event ID, contexto, escopo).", en: "Confirm relevance (event ID, context, scope)." },
        { pt: "Checar repeti√ß√£o/padr√£o (frequ√™ncia, timeframe, IP/usu√°rio).", en: "Check repetition/pattern (frequency, timeframe, IP/user)." },
        { pt: "Correlacionar eventos relacionados (ex.: 4625 ‚Üí 4624).", en: "Correlate related events (e.g., 4625 ‚Üí 4624)." },
        { pt: "Classificar severidade (impacto + evid√™ncia objetiva).", en: "Classify severity (impact + objective evidence)." },
        { pt: "Documentar no ticket: evid√™ncias, hip√≥tese, decis√£o e a√ß√£o.", en: "Document ticket: evidence, hypothesis, decision, action." },
        { pt: "Escalar para N2 quando houver sucesso/impacto/ambiguidades.", en: "Escalate to N2 on success/impact/uncertainty." }
      ],

      // ---------- i18n + rendering ----------
      setLang(lang){
        this.lang = lang;
        const data = translations[lang];

        document.documentElement.lang = (lang === 'pt') ? 'pt-BR' : 'en';

        document.querySelectorAll('[data-translate]').forEach(el=>{
          const key = el.getAttribute('data-translate');
          if (data[key]) el.innerHTML = data[key];
        });

        const btnPT = document.getElementById('btn-pt');
        const btnEN = document.getElementById('btn-en');
        btnPT.classList.toggle('active', lang === 'pt');
        btnEN.classList.toggle('active', lang === 'en');
        btnPT.setAttribute('aria-pressed', String(lang === 'pt'));
        btnEN.setAttribute('aria-pressed', String(lang === 'en'));

        try{ localStorage.setItem('lang', lang); }catch(_){}

        this.renderCapabilities();
        this.renderIncidents();
        this.renderProjects();
        this.renderWorkflow();
        this.updateMilestoneCountdown();
        this.seedLab();
      },

      renderCapabilities(){
        const el = document.getElementById('capabilities-grid');
        if (!el) return;
        el.innerHTML = "";
        for (const c of this.capabilities){
          const tags = c.tags.map(t => `<span class="tag">${t}</span>`).join("");
          el.insertAdjacentHTML('beforeend', `
            <article class="card">
              <div class="card-icon">${c.icon}</div>
              <h3>${c.title[this.lang] || c.title.pt}</h3>
              <p>${c.desc[this.lang] || c.desc.pt}</p>
              <div class="meta-row">${tags}</div>
            </article>
          `);
        }
      },

      renderIncidents(){
        const el = document.getElementById('incidents-grid');
        if (!el) return;
        el.innerHTML = "";
        for (const inc of this.incidents){
          const metaTags = inc.meta.map(m => {
            const label = m.k;
            const val = (m.v && (m.v[this.lang] || m.v.pt)) ? (m.v[this.lang] || m.v.pt) : "";
            const cls =
              (label === "Severity" || label === "Severidade") ?
                (String(val).toLowerCase().includes("high") || String(val).toLowerCase().includes("alta") ? "tag warn" :
                 String(val).toLowerCase().includes("medium") || String(val).toLowerCase().includes("m√©dia") ? "tag info" :
                 "tag") :
              "tag";
            return `<span class="${cls}">${label}: ${val}</span>`;
          }).join("");

          const tags = inc.tags.map(t => `<span class="tag">${t}</span>`).join("");

          el.insertAdjacentHTML('beforeend', `
            <div class="card" style="border-left:4px solid rgba(16,185,129,0.75)">
              <div class="card-icon">${inc.icon}</div>
              <h3>${inc.title[this.lang] || inc.title.pt}</h3>
              <p>${inc.summary[this.lang] || inc.summary.pt}</p>

              <div class="meta-row">${metaTags}</div>

              <div class="incident-body">
                <div class="kv">${inc.evidence}</div>
                <p style="color:var(--text-secondary); font-size:.92rem">${inc.decision[this.lang] || inc.decision.pt}</p>
              </div>

              <div class="meta-row" style="margin-top:1rem">${tags}</div>
            </div>
          `);
        }
      },

      renderProjects(){
        const el = document.getElementById('projects-grid');
        if (!el) return;
        el.innerHTML = "";

        for (const p of this.projects){
          const tags = p.tags.map(t => `<span class="tag">${t}</span>`).join("");

          // ‚úÖ Supports one or multiple links
          const linksHTML = (() => {
            if (p.links?.page && p.links?.repo){
              return `
                <a class="project-link" href="${p.links.page.href}">${this.lang === 'pt' ? p.links.page.label_pt : p.links.page.label_en}</a>
                <a class="project-link" href="${p.links.repo.href}" target="_blank" rel="noopener noreferrer">${this.lang === 'pt' ? p.links.repo.label_pt : p.links.repo.label_en}</a>
              `;
            }
            if (p.link){
              return `<a class="project-link" href="${p.link.href}" target="_blank" rel="noopener noreferrer">${this.lang === 'pt' ? p.link.label_pt : p.link.label_en}</a>`;
            }
            return `<span class="muted disabled">${this.lang === 'pt' ? 'Write-up: em constru√ß√£o' : 'Write-up: in progress'}</span>`;
          })();

          el.insertAdjacentHTML('beforeend', `
            <article class="card">
              <div class="card-icon">${p.icon}</div>
              <h3>${p.title[this.lang] || p.title.pt}</h3>
              <p>${p.desc[this.lang] || p.desc.pt}</p>
              <div class="meta-row">${tags}</div>
              <div class="link-row">${linksHTML}</div>
            </article>
          `);
        }
      },

      renderWorkflow(){
        const el = document.getElementById('workflow-steps');
        if (!el) return;
        el.innerHTML = "";
        this.workflow.forEach((s, idx) => {
          el.insertAdjacentHTML('beforeend', `
            <div class="step">
              <div class="step-num">${idx+1}</div>
              <div>
                <div class="mono" style="font-size:.88rem; color:var(--text-primary)">${this.lang === 'pt' ? 'Passo' : 'Step'} ${idx+1}</div>
                <p>${s[this.lang] || s.pt}</p>
              </div>
            </div>
          `);
        });
      },

      updateMilestoneCountdown(){
        const el = document.getElementById('grad-counter');
        if (!el) return;

        const targetDate = new Date(this.milestoneTargetISO);
        const now = new Date();
        const diff = targetDate - now;

        if (isNaN(targetDate.getTime())){
          el.innerText = this.lang === 'pt' ? "‚è≥ Ajustar data" : "‚è≥ Set date";
          return;
        }
        if (diff <= 0){
          el.innerText = this.lang === 'pt' ? "Marco atingido ‚úÖ" : "Milestone reached ‚úÖ";
          return;
        }
        const daysLeft = Math.ceil(diff / (1000*60*60*24));
        el.innerText = this.lang === 'pt'
          ? `‚è≥ Pr√≥ximo marco em ${daysLeft} dias`
          : `‚è≥ Next milestone in ${daysLeft} days`;
      },

      // ---------- lab ----------
      sample4625(){
        return [
          "EventID=4625",
          "ProviderName=Microsoft-Windows-Security-Auditing",
          "Computer=WIN10-LAB01",
          "SubjectUserName=WIN10-LAB01$",
          "TargetUserName=thiago",
          "IpAddress=192.168.1.23",
          "WorkstationName=DESKTOP-OPS",
          "LogonType=3",
          "Status=0xC000006D",
          "SubStatus=0xC000006A",
          "FailureReason=Unknown user name or bad password",
          "TimeCreated=2026-02-20T19:12:44-03:00"
        ].join("\n");
      },

      seedLab(){
        const ta = document.getElementById('log_input');
        const out = document.getElementById('parse_output');
        if (!ta || !out) return;
        if (!ta.value.trim()){
          ta.value = this.sample4625();
        }
        out.style.color = 'var(--text-secondary)';
        out.textContent = "// Awaiting Input...";
      },

      extractIoCs(raw){
        const ipv4 = raw.match(/\b(?:(?:25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|1?\d?\d)\b/g) || [];
        const eventIdMatch = raw.match(/\b(?:EventID|Event Id|event_id|eventid)\s*[:=]\s*(\d{4})\b/i);
        const event_id = eventIdMatch ? eventIdMatch[1] : null;

        const targetUserMatch = raw.match(/\bTargetUserName\s*[:=]\s*([^\s\\\/\r\n]+)\b/i);
        const subjectUserMatch = raw.match(/\bSubjectUserName\s*[:=]\s*([^\s\\\/\r\n]+)\b/i);
        const user = (targetUserMatch && targetUserMatch[1]) || (subjectUserMatch && subjectUserMatch[1]) || null;

        const computerMatch = raw.match(/\bComputer\s*[:=]\s*([^\s\r\n]+)\b/i);
        const workstationMatch = raw.match(/\bWorkstationName\s*[:=]\s*([^\s\r\n]+)\b/i);
        const host = (computerMatch && computerMatch[1]) || (workstationMatch && workstationMatch[1]) || null;

        const statusMatch = raw.match(/\bStatus\s*[:=]\s*(0x[0-9A-Fa-f]+)\b/i);
        const subStatusMatch = raw.match(/\bSubStatus\s*[:=]\s*(0x[0-9A-Fa-f]+)\b/i);
        const logonTypeMatch = raw.match(/\bLogonType\s*[:=]\s*(\d+)\b/i);

        const uniqIps = Array.from(new Set(ipv4));

        return {
          event_id,
          ipv4: uniqIps,
          user,
          host,
          logon_type: logonTypeMatch ? logonTypeMatch[1] : null,
          status: statusMatch ? statusMatch[1] : null,
          sub_status: subStatusMatch ? subStatusMatch[1] : null
        };
      },

      suggestSeverity(extracted, raw){
        const has4624 = /\b(?:EventID|eventid)\s*[:=]\s*4624\b/i.test(raw);
        if (has4624) return "high";
        if (extracted.event_id === "4625") return "med";
        if (extracted.event_id) return "low";
        if ((extracted.ipv4 && extracted.ipv4.length) || extracted.user || extracted.host) return "low";
        return "low";
      },

      nextSteps(sev){
        const stepsPT = [];
        const stepsEN = [];

        stepsPT.push("- Confirmar repeti√ß√£o (quantidade/timeframe) no SIEM.");
        stepsPT.push("- Verificar se h√° 4624 subsequente (sucesso) para o mesmo user/IP.");
        stepsPT.push("- Checar se IP √© interno/externo e se o usu√°rio √© esperado.");
        stepsPT.push("- Documentar evid√™ncia e decis√£o no ticket (campos extra√≠dos).");
        if (sev === "high"){
          stepsPT.push("- Escalar para N2 imediatamente: poss√≠vel comprometimento (sucesso p√≥s-falha).");
        } else if (sev === "med"){
          stepsPT.push("- Escalar se houver impacto (m√∫ltiplas contas, IP externo, comportamento fora do baseline).");
        } else {
          stepsPT.push("- Monitorar recorr√™ncia e ajustar contexto antes de escalar.");
        }

        stepsEN.push("- Confirm repetition (count/timeframe) in SIEM.");
        stepsEN.push("- Check for subsequent 4624 (success) for same user/IP.");
        stepsEN.push("- Identify IP origin (internal/external) and whether user is expected.");
        stepsEN.push("- Document evidence + decision in ticket (extracted fields).");
        if (sev === "high"){
          stepsEN.push("- Escalate to N2 immediately: potential compromise (success after failures).");
        } else if (sev === "med"){
          stepsEN.push("- Escalate if impact exists (multiple accounts, external IP, out-of-baseline behavior).");
        } else {
          stepsEN.push("- Monitor recurrence and gather context before escalating.");
        }

        return (this.lang === "pt") ? stepsPT.join("\n") : stepsEN.join("\n");
      },

      formatResults(extracted, sev){
        const t = translations[this.lang];
        const sevLabel =
          sev === "high" ? t.sev_high :
          sev === "med" ? t.sev_med : t.sev_low;

        const lines = [];
        lines.push(`event_id     : ${extracted.event_id ?? "-"}`);
        lines.push(`user         : ${extracted.user ?? "-"}`);
        lines.push(`host         : ${extracted.host ?? "-"}`);
        lines.push(`ipv4         : ${(extracted.ipv4 && extracted.ipv4.length) ? extracted.ipv4.join(", ") : "-"}`);
        lines.push(`logon_type   : ${extracted.logon_type ?? "-"}`);
        lines.push(`status       : ${extracted.status ?? "-"}`);
        lines.push(`sub_status   : ${extracted.sub_status ?? "-"}`);
        lines.push("");
        lines.push(`severity     : ${sevLabel}`);
        if (extracted.event_id === "4625") lines.push(`mitre        : T1110 (Brute Force)`);
        return lines.join("\n");
      },

      parseLab(){
        const ta = document.getElementById('log_input');
        const out = document.getElementById('parse_output');
        if (!ta || !out) return;

        const raw = ta.value || "";
        const t = translations[this.lang];

        if (!raw.trim()){
          out.style.color = 'var(--accent-alert)';
          out.textContent = t.out_empty;
          return;
        }

        const extracted = this.extractIoCs(raw);
        const anyHit =
          extracted.event_id || (extracted.ipv4 && extracted.ipv4.length) ||
          extracted.user || extracted.host || extracted.status || extracted.sub_status;

        if (!anyHit){
          out.style.color = 'var(--accent-alert)';
          out.textContent = t.out_nohits;
          return;
        }

        const sev = this.suggestSeverity(extracted, raw);

        out.style.color = 'var(--text-primary)';
        out.textContent =
          `${t.out_results}\n\n` +
          `${this.formatResults(extracted, sev)}\n\n` +
          `${t.out_next}\n${this.nextSteps(sev)}`;
      },

      clearLab(){
        const ta = document.getElementById('log_input');
        const out = document.getElementById('parse_output');
        if (ta) ta.value = "";
        if (out){
          out.style.color = 'var(--text-secondary)';
          out.textContent = "// Awaiting Input...";
        }
      },

      runNameEffect(el){
        if (!el) return;
        if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

        const original = el.dataset.value || el.textContent;
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        let i = 0;

        const tick = () => {
          el.textContent = original.split("").map((ch, idx)=>{
            if (idx < i) return original[idx];
            return chars[Math.floor(Math.random()*chars.length)];
          }).join("");

          if (i >= original.length){
            el.textContent = original;
            return;
          }
          i += 1/5;
          requestAnimationFrame(tick);
        };

        requestAnimationFrame(tick);
      }
    };

    // =======================
    // INIT
    // =======================
    document.addEventListener('DOMContentLoaded', () => {
      // Language
      document.getElementById('btn-pt')?.addEventListener('click', () => app.setLang('pt'));
      document.getElementById('btn-en')?.addEventListener('click', () => app.setLang('en'));

      // Print
      document.getElementById('btn-print')?.addEventListener('click', (e) => { e.preventDefault(); window.print(); });

      // Lab
      document.getElementById('btn_parse')?.addEventListener('click', () => app.parseLab());
      document.getElementById('btn_sample')?.addEventListener('click', () => {
        const ta = document.getElementById('log_input');
        if (ta) ta.value = app.sample4625();
        app.parseLab();
      });
      document.getElementById('btn_clear')?.addEventListener('click', () => app.clearLab());

      // Apply language + render
      app.setLang(app.lang);
      app.runNameEffect(document.getElementById('name'));

      // Reveal animation
      const observer = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if (e.isIntersecting){
            e.target.classList.add('active');
            observer.unobserve(e.target);
          }
        });
      }, {threshold:0.12});
      document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));

      // Scroll spy
      const miniLinks = Array.from(document.querySelectorAll('.mini-nav a'));
      const spyObserver = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          if (entry.isIntersecting){
            miniLinks.forEach(link=>{
              const target = link.getAttribute('href');
              link.classList.toggle('active-link', target === `#${entry.target.id}`);
            });
          }
        });
      }, {threshold:0.5});

      miniLinks
        .map(a => document.querySelector(a.getAttribute('href')))
        .filter(Boolean)
        .forEach(sec => spyObserver.observe(sec));
    });
  </script>
</body>
</html>
